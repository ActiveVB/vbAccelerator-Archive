<html lang="en" >

<!-- Mirrored from www.vbaccelerator.com/home/VB/Code/Controls/ImageList/vbAccelerator_Image_List_Control/bugTrak2-1.asp by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Jun 2015 21:30:14 GMT -->
<head>
<title>vbAccelerator - Keys corrupted when persisted</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="As a number of my controls require image list support (Rebar and Toolbar control, Tab Control, S-Grid, Icon Menu Control, 
ActiveX Popup Menu DLL, Owner Drawn ComboEx Control and the Owner Drawn Combo and List box Control), it was about time 
I provided an Image List control to support them, so you don't have to distribute 590kb of COMCTL32.OCX just to get images 
in your app." /><link rel="stylesheet" href="../../../../../res/screen.css" media="SCREEN" /><link rel="stylesheet" href="../../../../../res/print.css" media="PRINT" /><link rel="SHORTCUT ICON" href="http://www.vbaccelerator.com/home/res/vbaccel.ico" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000.html";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="../../../../../../../pagead2.googlesyndication.com/pagead/f.txt">
</script>
</p>
</td>
<td></td>
</tr></tr><tr class="navbar"><td><a href="http://www.vbaccelerator.com/home/index.asp"><img width="125" height="25" src="../../../../../res/vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="http://www.vbaccelerator.com/home/index.asp">Home</a>&#160;.&#160;<a href="../../../../index.html">VB</a>&#160;.&#160;<a href="../../../index.html">Code</a>&#160;.&#160;<a href="../../index.html">Controls</a>&#160;.&#160;<a href="../index.html">ImageList</a>&#160;.&#160;<a href="article.html">vbAccelerator ImageList Control and Class v2.0</a>&#160;.&#160;<a href="bugTrak.html">BugTrak Summary</a>&#160;.&#160;Keys corrupted when persisted</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="../../../../../res/download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="ImageList_Class_Example__VB5_or_VB6.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />ImageList Class Example, VB5 or VB6</a> (57K)</p><p class="nav"><a href="ImageList_Control_Documentation.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />ImageList Control Documentation</a> (2K)</p><p /><p class="nav"><a href="VB5_ImageList_Control_Binary.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB5 ImageList Control Binary</a> (33K)</p><p class="nav"><a href="VB5_ImageList_Demonstration.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB5 ImageList Demonstration</a> (89K)</p><p class="nav"><a href="VB5_ImageList_Full_Source.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB5 ImageList Full Source</a> (153K)</p><p /><p class="nav"><a href="VB6_ImageList_Control_Binary.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB6 ImageList Control Binary</a> (32K)</p><p class="nav"><a href="VB6_ImageList_Demonstration.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB6 ImageList Demonstration</a> (56K)</p><p class="nav"><a href="VB6_ImageList_Full_Source.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />VB6 ImageList Full Source</a> (121K)</p><br /><br /><img src="../../../../../res/information.png" width="125" height="21" alt="Information" /><p class="nav">Article:2</p><p class="nav">&#160;&#160;<a href="http://www.vbaccelerator.com/linkto.asp?id=2&amp;type=Article&amp;title=vbAccelerator%20ImageList%20Control%20and%20Class%20v2%2E0">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="../../../../../res/bugTrak.png" width="125" height="21" alt="BugTrak System" />﻿<p class="nav"><a href="bugTrak.html">BugTrak</a></p><p class="nav"><a href="bugTrak.html#bugs"><img src="../../../../../res/btBug.png" width="16" height="16" alt="Bug" />&#160;Bugs:</a> 6 / 6</p><p class="nav"><a href="bugTrak.html#issues"><img src="../../../../../res/btIssue.png" width="16" height="16" alt="Issue" />&#160;Issues:</a> 0 / 0</p><p class="nav"><a href="bugTrak.html#questions"><img src="../../../../../res/btQuestion.png" width="16" height="16" alt="Question" />&#160;Questions:</a> 0 / 0</a></p><p class="nav">Updated:6 February 2004</p>
<br /><br /><img src="../../../../../res/updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="../../../../../res/update.png" width="8" height="8" alt="Update" />29 Mar 2003<br /><p class="update">Fixed all problems with inconsistent indexes being returned by 
the methods. Indexes returned by the control are now <i>always</i> 1-based.  The
<i>ItemPicture</i> method consequently now works correctly.</p></p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="../../../../../res/related.png" width="125" height="21" alt="Related Items" />﻿<p class="nav"><img src="../../../../../res/rel.png" width="8" height="8" alt="Related Item" /><a href="http://www.vbaccelerator.com/article.asp?id=931">Using the System Image List with (and without) vbAccelerator Controls</a></p><p class="nav"><img src="../../../../../res/rel.png" width="8" height="8" alt="Related Item" /><a href="http://www.vbaccelerator.com/article.asp?id=3406">Displaying Alpha (32bit) Icons with ImageLists</a></p><br /><br /><img src="../../../../../res/search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="http://www.google.com/search"><img src="../../../../../../../www.google.com/logos/Logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="http://www.vbaccelerator.com/home/The_Site/NewSite/article.asp"><img src="../../../../../res/newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>Keys corrupted when persisted</h1><h2>Summary</h2><table class="article"><tr><td>Id:</td><td>2.1</td></tr><tr><td>Type:</td><td><img src="../../../../../res/btBug.png" width="16" height="16" alt="Bug" />&#160;Bug</td></tr><tr><td>Current Status:</td><td>Open</td></tr></table><h2>Detail</h2><table class="article"><tr class="header"><td>6&#160;Jul&#160;2003</td><td>Open</td><td width="100%">Igor</td></tr><tr><td colspan="3"><p>Besides some minor bugs, my customers found one serious bug with in your control and I have fixed it! I am glad that I've fixed this bug because it was hard to repeat it on the computers in my office and I debugged the control "remotely" on computers of my customers. The fact is that that your control raises the error '9' ("Subscript out of range") in compiled applications when you issue the ItemIndex function with a string key of an icon (in VB IDE all is Ok). I place here the full description of this error and our fix, you can also find it and all other bugs fixed by me in the readme_10Tec.txt file in the attached project that contains the fixed version of the control.</p><p>The problem is that if you specify string keys for icons, the control stores them in a single string which contains the keys separated by the Chr(255) character. When you launch a compiled (exe) application that contains a vbAccelerator ImageList control with defined icon string keys, the control restores the string with icon keys but replaces the Chr(255) character on Chr(&amp;H3F), the question mark character ("?"), and therefore can not process icon keys properly.</p><p>We suppose that this error is caused by the following fact. VB deals with Unicode strings but it stores them in ASCII format in .frm files when you ssue the PropertyBag.WriteProperty method (vbAccelerator ImageList uses it to store the string that represents packed icon keys). Depending on the operating system locale settings the Chr(255) character may be restored properly or not in the corresponding Unicode character; in the last case it is replaced on the question mark character.</p><p>To fix this error we changed Chr(255) on the Tab character (vbTab or Chr(9)). This character is saved and restored properly regardless of system locale.</p></td></tr></table><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center"></p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="http://www.vbaccelerator.com/home/index.asp"><img width="125" height="25" src="../../../../../res/vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="http://www.vbaccelerator.com/home/index.asp">Home</a>&#160;.&#160;<a href="../../../../index.html">VB</a>&#160;.&#160;<a href="../../../index.html">Code</a>&#160;.&#160;<a href="../../index.html">Controls</a>&#160;.&#160;<a href="../index.html">ImageList</a>&#160;.&#160;<a href="article.html">vbAccelerator ImageList Control and Class v2.0</a>&#160;.&#160;<a href="bugTrak.html">BugTrak Summary</a>&#160;.&#160;Keys corrupted when persisted</p><br /><p class="nav"><a href="http://www.vbaccelerator.com/home/The_Site/Copyright/article.asp">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 6 July 2003</p></td><td></td></tr></table>
</body>
<!-- Mirrored from www.vbaccelerator.com/home/VB/Code/Controls/ImageList/vbAccelerator_Image_List_Control/bugTrak2-1.asp by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Jun 2015 21:30:14 GMT -->
</html>