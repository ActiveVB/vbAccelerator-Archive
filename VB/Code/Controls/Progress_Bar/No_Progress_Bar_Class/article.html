<html lang="en" >

<!-- Mirrored from www.vbaccelerator.com/home/VB/Code/Controls/Progress_Bar/No_Progress_Bar_Class/article.asp by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Jun 2015 20:55:08 GMT -->
<head>

<title>vbAccelerator - vbAccelerator Progress Bar Class</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="This article provides a class that allows you to draw progress bars onto any control,
form or API created object with a hDC property.  The drawing code is derived
from the vbAccelerator Progress Bar control and all functionality except Image Processing
and persistence of data is included.
" /><link rel="stylesheet" href="../../../../../res/screen.css" media="SCREEN" /><link rel="stylesheet" href="../../../../../res/print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000.html";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="../../../../../../../pagead2.googlesyndication.com/pagead/f.txt">
</script>
</p>
</td>
<td></td>
</tr></tr><tr class="navbar"><td><a href="http://www.vbaccelerator.com/home/index.asp"><img width="125" height="25" src="../../../../../res/vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="http://www.vbaccelerator.com/home/index.asp">Home</a>&#160;.&#160;<a href="../../../../index.html">VB</a>&#160;.&#160;<a href="../../../index.html">Code</a>&#160;.&#160;<a href="../../index.html">Controls</a>&#160;.&#160;<a href="../index.html">Progress Bar</a>&#160;.&#160;vbAccelerator Progress Bar Class</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="../../../../../res/download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="Progress_Bar_Class_Source_Code_and_Demonstration.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />Progress Bar Class Source Code and Demonstration</a> (34K)</p><br /><br /><img src="../../../../../res/information.png" width="125" height="21" alt="Information" /><p class="nav">Article:1414</p><p class="nav">&#160;&#160;<a href="http://www.vbaccelerator.com/linkto.asp?id=1414&amp;type=Article&amp;title=vbAccelerator%20Progress%20Bar%20Class">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="../../../../../res/bugTrak.png" width="125" height="21" alt="BugTrak System" />﻿<p class="nav"><a href="bugTrak.html">BugTrak</a></p><p class="nav"><a href="bugTrak.html#bugs"><img src="../../../../../res/btBug.png" width="16" height="16" alt="Bug" />&#160;Bugs:</a> 0 / 1</p><p class="nav"><a href="bugTrak.html#issues"><img src="../../../../../res/btIssue.png" width="16" height="16" alt="Issue" />&#160;Issues:</a> 0 / 0</p><p class="nav"><a href="bugTrak.html#questions"><img src="../../../../../res/btQuestion.png" width="16" height="16" alt="Question" />&#160;Questions:</a> 0 / 0</a></p><p class="nav">Updated:12 January 2004</p>
<br /><br /><img src="../../../../../res/updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="../../../../../res/update.png" width="8" height="8" alt="Update" />28 Mar 2003<br /><p class="update">Some of the enumerations supplied with the original release
of this class were awkward to use in VB since they clashed with some of VB's
own words (particularly <i>Left</i> and <i>Right</i>).  All the enumerations have been
modified so this problem no-longer occurs.</p></p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="../../../../../res/related.png" width="125" height="21" alt="Related Items" />﻿<br /><br /><img src="../../../../../res/search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="http://www.google.com/search"><img src="../../../../../../../www.google.com/logos/Logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="http://www.vbaccelerator.com/home/The_Site/NewSite/article.asp"><img src="../../../../../res/newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator Progress Bar Class</h1><p class="splash">Full progress bar functionality without the control</p><img src="progressBarClass.png" width="395" height="296" alt="Progress Bar Class Demonstration." /><p /><p>This article provides a class that allows you to draw progress bars onto any control,
form or API created object with a <i>hDC</i> property.  The drawing code is derived
from the vbAccelerator Progress Bar control and all functionality except Image Processing
and persistence of data is included.
</p><h2>Using the Class</h2><p>To incorporate this code into your project, you need to add:</p><ul><li>cProgresssBar.cls<br />This implements the progress bar itself.</li><li>pcMemDC.cls<br />This helper class provides storage for pictures and flicker-free drawing into
an off-screen DC for the progress bar.  You do not use any methods of this class when using
the progress bar (although you are free to use it anyway if its useful in your code!)</li></ul><p>To set up your application to use the control, first determine where you want the control
to paint. You have three options:</p><ol><li>Into a control dedicated to showing the progress bar.<br />
This is the easiest method since you don't have to work out the position to draw the object.
You can also apply a ToolTip to the progress bar through the control's <i>ToolTipText</i>
property. The control you use must support <i>hDC</i> and <i>hWnd</i> properties, for
example a PictureBox.</li><li>Onto some part of a form or control.<br />
When using this method, you need to provide the rectangle to paint the progress bar into. 
Tooltip processing can be a little more tricky this way but it does conserve on resources.</li><li>Onto an API created object with a hDC property.<br />
Similar to painting on some part of a form or control, except you need to provide a <i>hWnd</i>
(this can be any hWnd in your application, it does not have to be related to the thing you're
drawing the progress bar onto), the <i>hDC</i> of the control to draw into and the rectangle.</li></ol><p>To draw into a picture box, let's say it is called <i>picProgress</i>, the 
code would be like this:</p><pre>
Private m_cProgress As New ProgressBar

Private Sub Form_Load()

   ' Set up properties:
   With m_cProgress
      .DrawObject = picProgress
      .Min = 0
      .Max = 100
      .XpStyle = True
   End With

End Sub

Private Sub picProgress_Paint()
   ' Ensure the bar redraws:
   m_cProgress.Paint
End Sub

Private Sub DoSomethingWithProgress()
   ' Do some work
   ' ...

   ' Update the progress bar:
   m_cProgress.Value = m_cProgress.Value + 1
      
End Sub
</pre><p>Note that you should not set the <i>AutoRedraw</i> property of the object you
are painting on, otherwise changing the value or similar will not work because the
<i>Refresh</i> method has to be called before changes are displayed.</p><p>To draw onto a specific rectangle is similar, except you do not set the <i>DrawObject</i>
property.  In the <i>Paint</i> event, use the <i>DrawToDC</i> method which allows you
to pass in a <i>hWnd</i> to use to detect XP Styles, the <i>hDC</i> to draw on and the
bounding rectangle to draw the control in.  Note that the code as delivered will not
automatically repaint the progress bar when you set the any of the properties like value 
so you will need to force a repaint.  You can switch on automatic repainting by 
uncommenting the <i>InvalidateRect</i> line in the <i>Draw</i> sub of the <i>cProgressBar</i>
class.</p><p>Drawing onto an API control is performed in the exact same way as drawing onto a specific
rectangle.</p><h2>Documentation</h2><p>Refer to the control article for full documentation on the methods 
and properties of the class.</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center"></p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="http://www.vbaccelerator.com/home/index.asp"><img width="125" height="25" src="../../../../../res/vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="http://www.vbaccelerator.com/home/index.asp">Home</a>&#160;.&#160;<a href="../../../../index.html">VB</a>&#160;.&#160;<a href="../../../index.html">Code</a>&#160;.&#160;<a href="../../index.html">Controls</a>&#160;.&#160;<a href="../index.html">Progress Bar</a>&#160;.&#160;vbAccelerator Progress Bar Class</p><br /><p class="nav"><a href="http://www.vbaccelerator.com/home/The_Site/Copyright/article.asp">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 10 April 2003</p></td><td></td></tr></table>
</body>
<!-- Mirrored from www.vbaccelerator.com/home/VB/Code/Controls/Progress_Bar/No_Progress_Bar_Class/article.asp by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Jun 2015 20:55:10 GMT -->
</html>
