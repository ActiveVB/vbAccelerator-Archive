<html lang="en" >

<!-- Mirrored from www.vbaccelerator.com/home/VB/Code/Libraries/Windows/Forcing_a_Window_to_Show_in_the_TaskBar/Show_In_Taskbar_zip_modStyles_bas.asp by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Jun 2015 21:25:42 GMT -->
<head>
<title>vbAccelerator - Contents of code file: modStyles.bas</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: modStyles.bas" /><link rel="stylesheet" href="../../../../../res/screen.css" media="SCREEN" /><link rel="stylesheet" href="../../../../../res/print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000.html";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="../../../../../../../pagead2.googlesyndication.com/pagead/f.txt">
</script>
</p>
</td>
<td></td>
</tr></tr><tr class="navbar"><td><a href="http://www.vbaccelerator.com/home/index.asp"><img width="125" height="25" src="../../../../../res/vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="http://www.vbaccelerator.com/home/index.asp">Home</a>&#160;.&#160;<a href="../../../../index.html">VB</a>&#160;.&#160;<a href="../../../index.html">Code</a>&#160;.&#160;<a href="../../index.html">Libraries</a>&#160;.&#160;<a href="../index.html">Windows</a>&#160;.&#160;<a href="article.html">Forcing Any Window to Show in the Taskbar</a>&#160;.&#160;<a href="Show_In_Taskbar.html">Show In Taskbar</a>&#160;.&#160;modStyles.bas</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="../../../../../res/download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="Show_In_Taskbar.html"><img src="../../../../../res/get.png" width="8" height="8" alt="Download Page" />Show In Taskbar</a> (29K)</p><br /><br /><img src="../../../../../res/information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:5053</p><p class="nav">&#160;&#160;<a href="http://www.vbaccelerator.com/linkto.asp?id=5053&amp;type=Zip&amp;title=Show%20In%20Taskbar%2Ezip%5FmodStyles">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="../../../../../res/bugTrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="../../../../../res/updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="../../../../../res/update.png" width="8" height="8" alt="Update" />21 Mar 2000<br />First Posted</p><br /><br /><img src="../../../../../res/related.png" width="125" height="21" alt="Related Items" />﻿<p class="nav"><img src="../../../../../res/rel.png" width="8" height="8" alt="Related Item" /><a href="http://www.vbaccelerator.com/article.asp?id=12338">Win32 Hooks in VB - The vbAccelerator Hook Library</a></p><br /><br /><img src="../../../../../res/search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="http://www.google.com/search"><img src="../../../../../../../www.google.com/logos/Logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="http://www.vbaccelerator.com/home/The_Site/NewSite/article.asp"><img src="../../../../../res/newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: modStyles.bas</h1><pre>Attribute VB_Name = "modStyles"
Option Explicit

' SetStyles sample by Matt Hart - vbhelp@matthart.com
' http://matthart.com
' - mods SPM http://vbAccelerator.com/

Private Type CWPSTRUCT
    lParam As Long
    wParam As Long
    message As Long
    hwnd As Long
End Type

Private Type CREATESTRUCT
    lpCreateParams As Long
    hInstance As Long
    hMenu As Long
    hWndParent As Long
    cy As Long
    cx As Long
    y As Long
    x As Long
    style As Long
    lpszName As Long    ' String
    lpszClass As Long   ' String
    ExStyle As Long
End Type

Private Declare Function CallNextHookEx Lib "user32" (ByVal hHook As Long,
 ByVal ncode As Long, ByVal wParam As Long, lParam As Any) As Long
Private Declare Function CallWindowProc Lib "user32" Alias "CallWindowProcA"
 (ByVal lpPrevWndFunc As Long, ByVal hwnd As Long, ByVal Msg As Long, ByVal
 wParam As Long, ByVal lParam As Long) As Long
Private Declare Sub CopyMemory Lib "kernel32" Alias "RtlMoveMemory" (hpvDest As
 Any, hpvSource As Any, ByVal cbCopy As Long)
Private Declare Function GetWindowLong Lib "user32" Alias "GetWindowLongA"
 (ByVal hwnd As Long, ByVal nIndex As Long) As Long
Private Declare Function SetWindowLong Lib "user32" Alias "SetWindowLongA"
 (ByVal hwnd As Long, ByVal nIndex As Long, ByVal dwNewLong As Long) As Long
Private Declare Function SetWindowsHookEx Lib "user32" Alias
 "SetWindowsHookExA" (ByVal idHook As Long, ByVal lpfn As Long, ByVal hmod As
 Long, ByVal dwThreadId As Long) As Long
Private Declare Function UnhookWindowsHookEx Lib "user32" (ByVal hHook As Long)
 As Long
Private Declare Function GetClassName Lib "user32" Alias "GetClassNameA" (ByVal
 hwnd As Long, ByVal lpClassName As String, ByVal nMaxCount As Long) As Long

Private Const WH_CALLWNDPROC = 4

' Misc Windows messages
Private Const WM_CREATE = &amp;H1
Private Const WM_DESTROY = &amp;H2
Private Const WM_PARENTNOTIFY = &amp;H210

' Window Styles
Private Const WS_OVERLAPPED = &amp;H0&amp;
Private Const WS_POPUP = &amp;H80000000
Private Const WS_CHILD = &amp;H40000000
Private Const WS_MINIMIZE = &amp;H20000000
Private Const WS_VISIBLE = &amp;H10000000
Private Const WS_DISABLED = &amp;H8000000
Private Const WS_CLIPSIBLINGS = &amp;H4000000
Private Const WS_CLIPCHILDREN = &amp;H2000000
Private Const WS_MAXIMIZE = &amp;H1000000
Private Const WS_CAPTION = &amp;HC00000                  '  WS_BORDER Or WS_DLGFRAME
Private Const WS_BORDER = &amp;H800000
Private Const WS_DLGFRAME = &amp;H400000
Private Const WS_VSCROLL = &amp;H200000
Private Const WS_HSCROLL = &amp;H100000
Private Const WS_SYSMENU = &amp;H80000
Private Const WS_THICKFRAME = &amp;H40000
Private Const WS_GROUP = &amp;H20000
Private Const WS_TABSTOP = &amp;H10000

Private Const WS_MINIMIZEBOX = &amp;H20000
Private Const WS_MAXIMIZEBOX = &amp;H10000

Private Const WS_TILED = WS_OVERLAPPED
Private Const WS_ICONIC = WS_MINIMIZE
Private Const WS_SIZEBOX = WS_THICKFRAME
Private Const WS_OVERLAPPEDWINDOW = (WS_OVERLAPPED Or WS_CAPTION Or WS_SYSMENU
 Or WS_THICKFRAME Or WS_MINIMIZEBOX Or WS_MAXIMIZEBOX)
Private Const WS_TILEDWINDOW = WS_OVERLAPPEDWINDOW
'
'   Common Window Styles
'  /
Private Const WS_POPUPWINDOW = (WS_POPUP Or WS_BORDER Or WS_SYSMENU)
Private Const WS_CHILDWINDOW = (WS_CHILD)

' Extended Window Styles
Private Const WS_EX_DLGMODALFRAME = &amp;H1&amp;
Private Const WS_EX_NOPARENTNOTIFY = &amp;H4&amp;
Private Const WS_EX_TOPMOST = &amp;H8&amp;
Private Const WS_EX_ACCEPTFILES = &amp;H10&amp;
Private Const WS_EX_TRANSPARENT = &amp;H20&amp;

Private Const WS_EX_APPWINDOW = &amp;H40000
Private Const WS_EX_TOOLWINDOW = &amp;H80&amp;

Private Const GWL_EXSTYLE = (-20)
Private Const GWL_WNDPROC = (-4)

' VB5 &amp; VB6 class names:
Private Const C_MDIFORMCLASS_IDE = "ThunderMDIForm"
Private Const C_MDIFORMCLASS_EXE = "ThunderRT6MDIForm"
Private Const C_MDIFORMCLASS5_IDE = "ThunderMDIForm"
Private Const C_MDIFORMCLASS5_EXE = "ThunderRT5MDIForm"
 
Private Const C_FORMCLASS_IDE_DC = "ThunderFormDC"
Private Const C_FORMCLASS_EXE_DC = "ThunderRT6FormDC"
Private Const C_FORMCLASS_IDE = "ThunderForm"
Private Const C_FORMCLASS_EXE = "ThunderRT6Form"
Private Const C_FORMCLASS5_IDE = "ThunderForm"
Private Const C_FORMCLASS5_EXE = "ThunderRT5Form"

Private m_hHook As Long
Private m_lHookWndProc As Long

Public Function LoginValidate(ByRef f As frmLogin) As Boolean
   If Len(f.UID) &gt; 0 Then
      If Len(f.Password) &gt; 0 Then
         ' check password...
         LoginValidate = True
      Else
         MsgBox "Please enter a password", vbExclamation
         f.txtPassword.SetFocus
      End If
   Else
      MsgBox "Please enter your user id", vbExclamation
      f.txtUID.SetFocus
   End If
End Function

Public Sub Main()
   
   ' SPM : if Form_Initialize is to fire each time, must explicitly
   ' create a new form instance, rather than using VB's lazy New
   ' facility:
   Dim fS As New frmLogin
   fS.UID = "stevemac"
   fS.Show vbModal
   If Not fS.Cancelled Then
      'MsgBox "Entered details ok", vbInformation
      frmMain.Show
   End If
   
End Sub

Public Sub HookAttach()
   m_hHook = SetWindowsHookEx(WH_CALLWNDPROC, AddressOf AppHook, App.hInstance,
    App.ThreadID)
   Debug.Assert m_hHook &lt;&gt; 0
End Sub
Public Sub HookDetach()
   If m_hHook &lt;&gt; 0 Then
      UnhookWindowsHookEx m_hHook
      m_hHook = 0
   End If
End Sub

Private Function AppHook(ByVal idHook As Long, ByVal wParam As Long, ByVal
 lParam As Long) As Long
Dim CWP As CWPSTRUCT
Dim k As Long, aClass As String
    
   If idHook &gt;= 0 Then
      CopyMemory CWP, ByVal lParam, Len(CWP)
      Select Case CWP.message
      Case WM_CREATE
          aClass = Space$(128)
          k = GetClassName(CWP.hwnd, ByVal aClass, 128)
          aClass = Left$(aClass, k)
          If IsIn(aClass, C_MDIFORMCLASS_IDE, C_MDIFORMCLASS_EXE,
           C_MDIFORMCLASS5_IDE, _
              C_MDIFORMCLASS5_EXE, C_FORMCLASS_IDE_DC, C_FORMCLASS_EXE_DC,
               C_FORMCLASS_IDE, _
              C_FORMCLASS_EXE, C_FORMCLASS5_IDE, C_FORMCLASS5_EXE) Then
             m_lHookWndProc = SetWindowLong(CWP.hwnd, GWL_WNDPROC, AddressOf
              Form_WndProc)
          End If
      End Select
   End If
   AppHook = CallNextHookEx(m_hHook, idHook, wParam, ByVal lParam)
End Function

Private Function Form_WndProc(ByVal hwnd As Long, ByVal Msg As Long, ByVal
 wParam As Long, ByVal lParam As Long) As Long
Dim lSetStyleEX As Long
   ' SPM - specific wnd proc for a form.  Only called once for the WM_CREATE
    message.
   Select Case Msg
   Case WM_CREATE
      Dim tCS As CREATESTRUCT
      CopyMemory tCS, ByVal lParam, Len(tCS)
      lSetStyleEX = GetWindowLong(hwnd, GWL_EXSTYLE)
      lSetStyleEX = lSetStyleEX Or WS_EX_APPWINDOW
      lSetStyleEX = lSetStyleEX And (Not WS_EX_TOOLWINDOW)
      tCS.ExStyle = lSetStyleEX
      CopyMemory ByVal lParam, tCS, Len(tCS)
      SetWindowLong hwnd, GWL_WNDPROC, m_lHookWndProc
      SetWindowLong hwnd, GWL_EXSTYLE, tCS.ExStyle
   End Select
   Form_WndProc = CallWindowProc(m_lHookWndProc, hwnd, Msg, wParam, lParam)
End Function

Private Function IsIn(ByVal vComp As Variant, ParamArray vTo() As Variant) As
 Boolean
Dim i As Long, iL As Long, iU As Long
   On Error Resume Next
   iU = UBound(vTo)
   If Err.Number = 0 Then
      iL = LBound(vTo)
      For i = iL To iU
         If vComp = vTo(i) Then
            IsIn = True
            Exit Function
         End If
      Next i
   End If
End Function
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center"></p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="http://www.vbaccelerator.com/home/index.asp"><img width="125" height="25" src="../../../../../res/vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="http://www.vbaccelerator.com/home/index.asp">Home</a>&#160;.&#160;<a href="../../../../index.html">VB</a>&#160;.&#160;<a href="../../../index.html">Code</a>&#160;.&#160;<a href="../../index.html">Libraries</a>&#160;.&#160;<a href="../index.html">Windows</a>&#160;.&#160;<a href="article.html">Forcing Any Window to Show in the Taskbar</a>&#160;.&#160;<a href="Show_In_Taskbar.html">Show In Taskbar</a>&#160;.&#160;modStyles.bas</p><br /><p class="nav"><a href="http://www.vbaccelerator.com/home/The_Site/Copyright/article.asp">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 12 April 2003</p></td><td></td></tr></table>
</body>
<!-- Mirrored from www.vbaccelerator.com/home/VB/Code/Libraries/Windows/Forcing_a_Window_to_Show_in_the_TaskBar/Show_In_Taskbar_zip_modStyles_bas.asp by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 Jun 2015 21:25:42 GMT -->
</html>